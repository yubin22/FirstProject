<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC 
	"-//iBATIS.com//DTD SQL Map 2.0//EN"
	"http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap>
 
 <cacheModel type="LRU" id="guestCashe">
 	<flushInterval hours="24"/>
 	<flushOnExecute statement="insertGuest"/>
 	<property name="size" value="10"/>
 </cacheModel>
 
 
 <!-- typeAlias : 해당 클래스에 별명 지정  -->
 <typeAlias alias="login" type="model.LoginDTO" />
 <typeAlias alias="save" type="model.SaveLocationDTO" />
 
 <resultMap class="save" id="saveResult"> <!-- queryForMap,List 사용위해 -->
 
 	<result property="cartId" column="cart_id" /> 
	<result property="id" column="id" />  	 	
	<result property="locationNum" column="location_num" />    	 	
	<result property="region" column="region" />    	 
	
 </resultMap>
 
 <!-- 목록 추가 -->
 <insert id="addSave" parameterClass="save" >
 	insert into saved_location (cart_id, id, location_num)
 	values(#cart_id#, #id#, #locationNum#)
 </insert> 
 
<!-- 여행지 목록 -->
 <select id="getSave" parameterClass="save" resultMap="saveResult">
 	select s.cart_id, s.id, s.location_num, l.region
	from saved_location s
	join location l
	on (s.location_num = l.location_num)
 </select> 
 
 <!-- 내 여행지 목록 -->
 <select id="getSaveList" parameterClass="save" resultClass="save">
 	select s.cart_id, s.id, s.location_num, l.region
	from saved_location s
	join location l
	on (s.location_num = l.location_num)
	where id = #id#
 </select> 
 
 <!-- 목록 삭제 -->
 <delete id="deleteSave" parameterClass="int">
 	delete from saved_locationr where cart_id= #cartId#
 </delete>
 
 <!-- 이미 저장된 것이 있는지 체크 (목록, 회원 확인) -->
 <select id="checkSave" parameterClass="save" resultClass="save">
 	select location_num from saved_location where id = #id# and location_num = #locationNum#
 </select> 
 
  <!-- region의 상세정보 확인 -->
 <select id="getRegion" parameterClass="save" resultClass="save">
 	select location_num, region from location where location_num = #locationNum#
 </select> 
 
</sqlMap>